# üí≥ Telegram Payment Mini App —Å PayMaster

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –º–∏–Ω–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è Telegram —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã PayMaster –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∑–≤–µ–∑–¥.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Web App API
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ PayMaster (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)
- ‚úÖ –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–≤–µ–∑–¥ (10, 25, 50, 100)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∏ webhook'–æ–≤
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- FastAPI
- PayMaster —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç
- Telegram Bot Token

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone <your-repo>
cd backend
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install -r requirements.txt
```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```env
PAYMASTER_TOKEN=1744374395:TEST:1a8282597a855bf711c0
PAYMASTER_URL=https://sandbox.paymaster.ru/api/v2/invoices
TELEGRAM_BOT_TOKEN=8302025614:AAGiJVFrJwun-DJneCbqetbtJX4VM2O8B7Q
```

## üöÄ –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
python run.py
```

### –ü—Ä–æ–¥–∞–∫—à–Ω:
```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

## üì± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather**
2. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∏–Ω–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newapp` @BotFather
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
   - –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-domain.com`)
   - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∫–æ–Ω–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ main.py              # –û—Å–Ω–æ–≤–Ω–æ–π FastAPI —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ run.py              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ static/             # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ index.html      # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ styles.css      # –°—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ app.js          # JavaScript –ª–æ–≥–∏–∫–∞
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîå API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

- `GET /` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∏–Ω–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
- `POST /create_invoice` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å—á–µ—Ç–∞
- `POST /payment_webhook` - Webhook –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π PayMaster
- `GET /payment_status/{invoice_id}` - –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞

### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞:

```bash
curl -X POST "http://localhost:8000/create_invoice" \
     -H "Content-Type: application/json" \
     -d '{"user_id": 123456, "stars": 25}'
```

## üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PayMaster

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [PayMaster](https://paymaster.ru)**
2. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook URL** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
   - URL: `https://your-domain.com/payment_webhook`
   - –ú–µ—Ç–æ–¥: POST

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `static/index.html`:
```html
<div class="star-option" data-stars="10">
    <div class="star-price">10 ‚ÇΩ</div>
</div>
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `static/styles.css`:
```css
:root {
    --primary-color: #0088cc;
    --secondary-color: #f8f9fa;
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–ø—Ü–∏–π:
1. –î–æ–±–∞–≤—å—Ç–µ HTML –≤ `static/index.html`
2. –û–±–Ω–æ–≤–∏—Ç–µ JavaScript –≤ `static/app.js`
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ CSS

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:
```bash
tail -f logs/app.log
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:8000/health

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
curl -X POST http://localhost:8000/create_invoice \
     -H "Content-Type: application/json" \
     -d '{"user_id": 123, "stars": 10}'
```

## üì¶ –î–µ–ø–ª–æ–π

### Heroku:
```bash
heroku create your-app-name
git push heroku main
```

### Docker:
```bash
docker build -t telegram-payment-app .
docker run -p 8000:8000 telegram-payment-app
```

### VPS:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ nginx
sudo apt install nginx

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ reverse proxy
sudo nano /etc/nginx/sites-available/telegram-app

# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Å–∞–π—Ç
sudo ln -s /etc/nginx/sites-available/telegram-app /etc/nginx/sites-enabled/
sudo systemctl restart nginx
```

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å PayMaster API
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –º–∏–Ω–∏–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

---

**–£–¥–∞—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏! üöÄ**
