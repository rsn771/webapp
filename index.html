<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Покупка звёзд</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
<style>
html, body { margin:0; padding:0; overflow:hidden; width:100%; height:100%; background:#0a1f44; font-family: Arial, sans-serif; }
.card {
  position:absolute;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  background: rgba(255,255,255,0.1);
  border-radius:2rem;
  padding:2rem;
  text-align:center;
  backdrop-filter: blur(0.5rem);
  z-index:10;
  width: 80vw;
  max-width: 400px;
}
.card h2 { color:#fff; margin-bottom:1rem; font-size:1.5rem; }
.card button {
  background:#0088cc;
  color:white;
  border:none;
  padding:0.8rem 1.5rem;
  margin:0.3rem;
  border-radius:1rem;
  font-size:1rem;
  cursor:pointer;
  transition:0.2s;
  width: 45%;
}
.card button:hover { background:#0077b3; }
canvas { display:block; width:100%; height:100%; }
</style>
</head>
<body>

<div class="card">
  <h2>⭐ Купить звёзды</h2>
  <p>Выберите количество:</p>
  <div class="buttons">
    <button onclick="chooseStars(100)">100 ⭐</button>
    <button onclick="chooseStars(500)">500 ⭐</button>
    <button onclick="chooseStars(1000)">1000 ⭐</button>
  </div>
</div>

<script>
Telegram.WebApp.ready();

function chooseStars(amount){
  Telegram.WebApp.sendData(amount.toString());
  Telegram.WebApp.showAlert(`Вы выбрали ${amount} ⭐`);
}

// === Three.js сцена ===
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x0a1f44); // темно-синий фон

const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 50;

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Свет
const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
scene.add(ambientLight);
const pointLight = new THREE.PointLight(0xffffff,1);
pointLight.position.set(50,50,50);
scene.add(pointLight);

// Золотой материал для звезд
const goldMaterial = new THREE.MeshStandardMaterial({ color:0xFFD700, metalness:0.8, roughness:0.3 });

// Функция создания пятиконечной звезды
function createStarGeometry(size=1){
  const shape = new THREE.Shape();
  const outer = size;
  const inner = size * 0.5;
  for(let i=0;i<5;i++){
    let theta = (i*2*Math.PI)/5 - Math.PI/2;
    let x = outer * Math.cos(theta);
    let y = outer * Math.sin(theta);
    if(i===0) shape.moveTo(x,y); else shape.lineTo(x,y);
    theta += Math.PI/5;
    x = inner * Math.cos(theta);
    y = inner * Math.sin(theta);
    shape.lineTo(x,y);
  }
  shape.closePath();
  const extrudeSettings = { depth: 0.3, bevelEnabled: true, bevelThickness:0.1, bevelSize:0.1, bevelSegments:1 };
  return new THREE.ExtrudeGeometry(shape, extrudeSettings);
}

// Создаём несколько звёзд
const stars = [];
for(let i=0;i<40;i++){
  const geometry = createStarGeometry(1 + Math.random()*0.5);
  const star = new THREE.Mesh(geometry, goldMaterial);
  star.position.set((Math.random()-0.5)*100, (Math.random()-0.5)*100, (Math.random()-0.5)*50);
  star.rotationSpeed = Math.random()*0.02;
  star.merger = Math.random()*0.5 + 0.5; // мерцание
  scene.add(star);
  stars.push(star);
}

// Анимация
function animate(){
  requestAnimationFrame(animate);
  for(let star of stars){
    star.rotation.x += star.rotationSpeed;
    star.rotation.y += star.rotationSpeed;
    star.position.y -= 0.2;
    star.scale.setScalar(0.8 + 0.2*Math.sin(Date.now()*0.002*star.merger)); // мерцание
    if(star.position.y < -60) star.position.y = 60;
  }
  renderer.render(scene, camera);
}

animate();

window.addEventListener('resize',()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>